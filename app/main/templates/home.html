<ion-view title="Location Preferences">
  <ion-nav-buttons side="primary">
    <a class="button button-large button-dark" ui-sref="userPref">
      <i class="icon ion-android-contact"></i>
      User Profile
    </a>
  </ion-nav-buttons>
  <ion-content class="padding">
    <ion-list>
      <form name="facilityPrefForm" novalidate
            ng-submit="mainCtrl.getRecommendation(facilityPrefForm.$valid)">
        <div class="list">
          <div class="item item-divider">
            <i class="ion-android-pin"></i>
            <span>Select location type</span>
          </div>

          <ion-radio name="placeType"
                     ng-required="true"
                     ng-repeat="type in mainCtrl.locTypes"
                     ng-model="mainCtrl.placeType"
                     ng-value="type.code">
            {{ type.name }}
          </ion-radio>
        </div>
        <button type="submit" class="button button-block button-positive button-large">
          <span>Get Recommendation</span>
          <i class="ion-android-arrow-dropright-circle"></i>
        </button>
      </form>
    </ion-list>

    <!-- Empty recommended place div -->
    <ion-list ng-show="facilityPrefForm.$submitted && mainCtrl.locations.length === 0">
      <ion-item>
        <span>
          No facility met your requirement, please update your preferences or change location type!
        </span>
      </ion-item>
    </ion-list>

    <!-- Recommended places list view -->
    <ion-list ng-if="facilityPrefForm.$submitted && mainCtrl.locations.length > 0">
      <ion-item class="item item-thumbnail-left"
                ng-repeat="loc in mainCtrl.locations track by $index">
        <img ng-src="loc.images[0]">
        <h2 ng-bind="loc.name"></h2>
        <p>Type: {{ loc.type }}</p>
        <p>Address: {{ loc.address }}</p>
        <p> Ammenities: {{ loc.ammenities.join(', ') }}</p>
        <label class="inline">
          Rating:
        </label>
        <rating ng-model="mainCtrl.ratings[loc._id]" max="5"
                state-on="'ion-ios-star'" state-off="'ion-ios-star-outline'">
        </rating>
        <button class="button button-positive button-large"
            ng-click="mainCtrl.submitRating(loc._id)"
            ng-disabled="mainCtrl.disable(loc._id)">
          <span>Submit rating</span>
          <i class="ion-ios-star-half"></i>
        </button>
      </ion-item>
    </ion-list>
  </ion-content>


</ion-view>